<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hackthebox Sherlocks OpTinselTrace24-4:Neural Noel</title>
      <link href="/2024/12/31/HTB-Sherlocks-OpTinselTrace24-4-Neural-Noel/"/>
      <url>/2024/12/31/HTB-Sherlocks-OpTinselTrace24-4-Neural-Noel/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="884b91b2e8596122c956a6e1bae7a245b8dceb80177c71aa9fbf9384abfe3117">01a4bd3231438c75f6f93ac035961db0b57de37986d9eebfae514866f8c37c850e0598e64bb85d8fa603479ed2e7a110d02bde54a0a49efc06b924e3ce0c4e4c5bdf6aa1cbfcab41b4232ae09f12d7c9ab4fa20817d5d12964c45e05472a3d519d4169cfa84c7ad9777115a7282173fa649f09821f1d65e2d2bb765e85fb791b57b638298bc7e1d426349b08af870620e044e72160c23a2827eccbc23e52f166f88a769101b29316b1a59de33d43399b7d557a65e6375bb6cf5f981da76d72f6a6a6c49c224d3e6642e195eaf94eb8eb1f23bc7d94f41f1efc6967209fdd67e4ba935d7ec85605ea57a9a28d0d3e4dc565141f3fed2d4ebc39d444762f2bd29964d205dec3af3dd8174ee48b028222ae2a5e915dcaf8212ed4358aebafab8926146f0e1389dd517eff0833a8ef80979ea3704e020c33c7add7283166a293a80dcb6b32af683b257db725c34dd120a052766bc095f4f75aeb98f99879b07202ef3577ff5def8b1d2ef5ab9d8adbb5f1a24c67a81bf07d48b5216fa5ba4fc5007efcafb6d720a01ae95d113c931faed56d3dbbc6136a23ad83eda39ad9b1427284262c2f99e5929d077fd9b0d774b7fde102a01a148536ca5405390c66384f51f01ea9dd577c7b987e1fd5bd3ffd00afda2d1f36d8844fc95807369f4cc9771cd2f717fd796d6d02d29e48ac66a9abd4f006357fe2e140e4e4b79d529d9ee69c9c78d12a2f7ad804630a87f0e9e2e66b49450a03ef19d4385cb0234c62e9ece684a4ae72fc6a5b014d0ab9fb89b453b2c79eff8b4e52daba547b9f36339337fe278eb333e84fc3e9f89e71dbc84e503aed0936b5e32ed5846d75a6b0a46bc1bea5317826dbbec46f48932c9ac32ee6f2eb8e890d636b8c379f598c10309cf1ec3b981b11fb24deb71da42026814db9807e73d1ef0fca8a4170f2af04c3a546a928e06e358fbfc75b5a8da0f0d1039d140fe2c85992972ca5fcb76e3e7b2a40aae3b45774dc061b11b2595b866ee2e331ef20bb0f55ed3bea96e39d619c4c3070ed578ed0770c473b6218399405a80c52c449d541c0d6a82db20361fe28df1b9c44825669c74e2bbd13968bf54b3585be65c4512c47eaae4dc367a9b701bfc424ae0f571e6cd9a8e23c07f25b44c666bb5d96f733f18eeaefc76d82dc4fb1326b40c8b58e78c0907aec406101cb0a08389803c6c4ed578b77c2ee6dbf6c978daba2e00293527a401bff5faa1eae28a6d723df7f7606b2bb9fcd03994d3bbfe9b63e65045c5c007cbaf850a4f4d1f0a3fc4b3526d86b29ec1d5b4aa7d8f9b9e9e8c6748cbbc4a5e8abc134afa1044dda4b57b2ec3980e34cbef2b5ad0a4ea24438767e0a0db9602def235afa0c750f9ca56cf46461fbeddd3172b45a92c52cc2bbcc0ff8278d287a7c47a453de6b392fd5f00cc932a507d9852331d4d78c55e73e2bb882906a622ccdd1978665395506c23c7b5dcfb63d41434372a4685237a543697fdc9a14aed9d486f0e8404b4dc5aba6681f0cc24d6a5bcbe940d3e52d3fd0b3de6512a4293d8c7fcaaa2df05fd638d6cb93c86883d82ca14f827df92c053d8c0912755eadd0ab86af2dd4fb23d2a18ca732b324b00c1751ba5b58323e7b2bc22a0ba5395ec99d30af7988bd8ae914e3ee99df62a12f2f79fb59e711473f74b480c54193d5a2ff96efbb87d9880a13447cd3857c3b93197810b415b8ac19a53ee1816f87fc43801469a1088331a51566515380af6fe7338223c27a6c568d541525d25262b6d752d0da735f1cdb83e75b098f9654cd0acf12eb48d5ec8070f2f7b0460842ba2e5371d2f2c6348c9366eebd5be107d5956ac520a1eefbd9fa86dd583ddb1391d9ff3daad3a8ebaefc7e1b363d7da74528eaa2faeb5eed09dfea5a8c5b181201bdbe721fef1ae633864e4ae3b06b33428ea55e0883a8deb9b8afa81d515c823e2f2c3f7be686e5dfa6559249d5c3a473d1c5342c46757c4055221e663a86b7456bd7d93a479c03944eb9963e4b78133e69c702d9ad4df734546dd5d0bf1b022a5f7d15c192c1ad77e7fc83ba426428fcfa0f48f5f3eb892cb5996648eae76c61a19132624b86c35715edcbce6ca8f4fd8073d0c0b8bcbfc24f96ffcf5a8d50697d581c3f2a8ef41e54029e2f4d5d04d9c549e9ac38ac1d9224ebf63ac983588014a685d20fed62c5ba606a10768e4432f18aa5e9879d077131e20d4872c36dc4eabbd8fc055491de2bc4e503d521170b4da767e0c5c6a2b251413c6e9cc72ea720a88b3f39e840a41d79d867a75dfad20d90c17ea0b5e84ef783f4080e1166481ad3d1b17ddf7b44789a2ea800edf060fe90baeb06d51bf27aaf401e8cc5f3302ccc7af513abb60b22c8869c7e9a2b21c555f278c16a51c00c6236ad28609fb54739e4b23ed184c72f0d19006d9368b18e89c5b785a4d827923be709b60be1425f596ce4bda5bd31d2ca9975a111082dd78767e4dd66789942070e80e54a23f5d28494476a5f6cc5a6c32f8de91b8647cd556cf2d679d5bbae456549a4bd8fc613d08aedab08dd2c30261c52bbe8b97af0f81631be8d7890cb9563af4320501f4173e2ea1c7e6c61032698e9915c4a2a953f37c0f8c8e77efb2ce1968431abddfa139edaa58cab0ec63f31d147cfbce65e6c8e1ed4de77151213f5c8ef68615b5c9a23070a0492b28043bba395f54ea3ad6db97e09878362c12bba70f47f10624541998704dd6e1d2e3de482fbe650a6817ef77fe37c022d5bccd3ea8321f431bc2c77a6b12d3253c959c286aff8463c2b01a87828cbf8c03e5ffeca17d216407c40f0068bf473333b493d9d65758730122451039f5dc599b6e24a61301caac2f8f25e3008cc9ded90e517c54b9305190d00094436ed01c36ff22ef78945b87054dbb4c7af591a62090ada401804a07068bf5d3d17c709289207f2ba533df41396e75c5f471aad590d67b667b78fe725559f093f21209a4643c6f2fdc9d2b6bfcd1e9e9cbd336eef2637cd660b8bacfbfe575f9d815738af09b02afbad8a60b6cc23618ee656d621bf4092945a5b59abcab9b7368e3ea99a0a4bb0e89c7298ce7aa7c433b64cdbfc327afd070461934331b0920725206065d3a8080307a5d9b76bbc7efe00a2fc32296ad0653fa75a42a432e6c07971aa7efa6b7d409ce2e8984961e9a59a7a9b440b5b8aec0f39f82b9897e535afe553581038b80fd9c235338649296cd98784a2be1b21ba6aec290e6273882387757975abe3821d8e6b21d11057cee196cd3971f9cb100d08c1e0e9fbd324370fc0c4e20f0d94019acfd4bafaf800e91e6e2f24a343cc6ead8d070e43b1d6a6cd7e84c2bd6405ea780ae33bb859fa84bfc9e9dd6713ed0853653a213e86ad1c0cbf876eba1964a3ad94a2231348f3b92ca4de5a3ac4e64e984889006ab2b6fc08dfa098b3d329624ec8efe8e9ea67e03170f669404999f7d21b27eb0a7db9a31bb8a68d5fb10851307b33b9cb7157ed5ac7eb12f327b22e3711495e36a17774595d843b3834ee5b9da6298fb67e9993b81a779b44f409fff647ce4755bc6655aab428760ed9c7323f4e3d1be1d214bb2bc34f08f1d57a1ccebf76be7dbd1f8f5d0296e5b4c5aa363fb221fbf936f6bf29b9b373109bcf0ff17364fb00be1305d1f45ce879b9e83ff799d2c269f020687727c5bee46a749626b40bbbe5341245f0482ba1bfbf6302a4ec75c95e805ea4f9ddc4cf2f709f382a594ee2cacbe680f24d8b514b58851ac526f9ec6cfde4932f960c7ce766e4e197e8e80b08d7581b80e6ffc31a09b3d270b7af5826543f50b0cfe3379d557384ad69b31fdb60d1b51279c0d2b54fe41a7226e646d4e503eac130c0ec1756da9e0d024c32255d879bd2cd8aedc12727218b8d4c1825798e2c1a24ece5ba2574730e14d787cf9f8073938a07abd97f61311cd0231968ffae8afde5811c68fcf3df5b4e424f800da91c5633c191035f6d003bf3321c13ffb9fe0a8e8f7c1f2ed73fcfc5e8650eda32a93df26efeeb315aca7b5c079dffd80c6235d30482136d695258927cd36f5b6bb59337ebdc601df7ca59ad067781a1999cbe6162b5da75bd0f8c62f125c8f75f65698629941384009bbf5f04db16ec676672904c78e837d006934714dcc849ecb5fa44b01079000ee998526ad9d7a2f31a0a4e4a27ddb58af7d84d5aedd26db47e5948bcd1f9f541f52b3519f29fdb9a632be88d33215300aeaa13fc29102ceda9f8b725f21cfb94c297149888f0af1f048bd2f8ce6421c233047fc378d3fa047768bfa34f1056b19b46b7605297ce9d60e0443f670509be6e78901b5d9e7a4db8324ad2d69ea64da76cba44a6165659e0f6e6454cacadd42c47fd157d51d7d55a7b53981b197d2ba034e8d4ad080f428e127da1abc4a6c03d841a5aee29148c8eaef840c6d489f7ec4d8053b004189a9e1091ee849ea6f28c0839bcc78f1ac31e096f165914c24bea4a5226a247400fcde04d06aa6a3313d548c97061b6baa9dc9436dced9b40d4222c06439dfd989bdb84de45f9c4efcdf6736b1d3d23d4ea16487f7ea08e5c84438ab9a1b7ccb32d1d1a3874a49f3f0e1b0be3c675f5f15287e50ba532dbff88463a5e0bdf98b8e8f1cb8f301b0c517ad7a6a4f314c80f037424dd693de0acb05b8b6576ab55484e3f1c211ccf715d108503a8c99243fdb492a48f94389efa0e448c4d0d3d88bd5b07ea33ccf7d3d8703d90e083073c3dcfc22c8a3f4267b499c68b9b1b87880b03dcb170e187938d88af18df204a41f6111939c2f444d2fe07584a15448d11680ad80b23367dde303ec9de8118319f510a5cf0f22e000508743d854c6b2724b361608e56ee843aa19c1bf391d9260c448dbaca7ffae0ae09e05e318f7006e51e4702790697072f6427f27d0809ea713db87770540a6363dd0c7707943cd6727ea6a6d13062cb8c2ee371b6565533cb7f97d9ffb9e64eb3b2c227465f5ec014a49f15ff015aad4bb50b93f369fc210781731f9a7774a040dccfc046b2d4f4b56f9cc546584f4c400e38ff356f1546d48f2ad32b7d921a13d07191c5be1a7c7f942b76aefb00290dbe95316e7cc50b8eb3bfb8d341eb51f4f1ae87c709f532545bded83b3756c66b5e9ef5893267002e249bbf456853e10086fc471678b59d1bbfbfb8b3fa1fce6dd334499f50541edb7f8e92cce1dfb6ff859760a7099160d44acfb30349dd4262ef28439c368f1396fba141b1de03d237b13017964b784938b8902159df27588ff7f107f9b71700ddd16ce5ec3af7986e97b64546f26aa284b9f08327f91a4665a3f8c05d07dbad50222688b584f4ae1e370c187a235c6d9664da844ed75526677e1b9e9c3d7602c927e3b3e34a426b198aaae7c50edeec8c62ecd510f7b8ad096fbe6ff5bd5a1481cc992c8ca13b7b8027201e816a3be9b5e31d6e073cf7ff1fb5ac1169165506e4fea6f7a78e7f323f416e1435f25245273856a01633bd2d66e239ee9026f29e5a373ca9aba66538a5032186a605f345e70cfaab5786e76bf9231c9735d49cfe0e5ccfb4475524d3871991b9dd19635ff487e6f8d18ec4b9a06108e488ad79c1548472c1350d03ee2238b6f8b368b1a2d854408f33d8f1cad7b942ff7970adba7334c38fe82a8a5858ba4b3137804d67e0711209ffc01600ca20136cfeeea9e7d4d3d910d190694501da2681c619aaa3529638de3d433434b35328b3b4054a6c7ed8569282aeab99974240e38ddf697ac5064476f83d7877ea52e01d9744f37c725aed52273fbfdde00634b5efed2de9a484bba9ec4e3702433b5d19f7d08286aeea0c941082d985468297a04ad185f8b5e7493121c43d827d3c24cf560ce347742a56c5718e00be4a7283cb523c31138d645a37dc03d2125c42c52f004d33a698ead10f3a3749688f6a793ea1b1d489135b80ad491a0187927af1f89d33f6f8a1f1fd5fd2427fd5c665a402b296468d9eae93347f185761eb809f192a0f0fa54f0ff5f1ac223ee3bf34ba2c96b3a557ea5d52e14333baa2528ab00f9920e6c049d594da3dfff2e2443d2778f02c188c11be5da0c5def4ddbf3543d3e4f3b3553a8668124227b16263e77d6445d1c4ce68e960246980604f67d8ca0eb2f626cf139f736ef406e4530402001958f87af9e61719346e3dda6bed74638bd95869feb8938667a69227a8674e18d4b6da17b66e1a69ea6db089da5003be496e6813f431d9217274a975342ee30da3b7efe3bfc14cd755fad48d0ad2cae33430da3c985e28b857f7248f74755e6950f656a302bfedb841e4872e6449909dbd0789a8d430ae85391ed9da616961013e4801a2697b5d33cee9250dabbd8edb95051d79caff10a475db7f3bb20244dd32dd2c559e06f2b38b06c21e67a3991dce96f2fe24147b8800189aae29f0e3ca1fdf65348593650e1adfc875c6e21b4765798ffd7933c1b8690d146077985c213a8536897fb541af646d3e5d78b670dcdf805ce9668b393ed5663bba02febead48ff8edb4c7d26d460746ce13200927608ed783372cd0f3f5b89867813fc5c6827e4ce67f848e46376327e97e30cb55c9dedb9607e2d86a08291fea8e436b392de5e544e83f80c35a5ca53aa114ff1e1ff567c18d6f33ecfb1f1a3ffe8e9acdf2fd8b8e66d3b25cd79175a2006ffe580c79a5a521501edd398cb163faedfe3206caa4de5bd42160d4977313f3a645ccb705f13fb5c1009c049be63271b40f5ddc139498a776627f1a9fcb003e2085b4061022db74c47bb5994a83950fc46be5e108ddb9586cc6014a2320255b4ba4affb6d40c20f2b20276224e517ecdebd5cdcb32382126337782bf162df59e5a8af4854e56fe8ae7d9746b61ac108ed3f07015124dd3a34c253b63c03ca5908b60052d5ad046b5ca56f7791c9ceeada8fa3866e1a4c86b1f6445707efa0d2366b55adf45abb1f7563bec22b511232d00c741ae1463c55d037fc0d9a77470df8d6d45eba8f725388bf5b5cfa243366c60179026213bf7cd7d582bad41ef4398bacb46c1858f14696f664ee21a695037536ad566b9bf0c2983641f9906d9b3848edb3b3e7fb12bb353120e1f1d3271513f669954ed00c82c981bc977f9000867056365f9af63ef86d0e8aaa832027afaed0e8ac6654e62a356add345e07fd5bcc787446c285cb7a09d109d1b3c09d1f9290e1813e4b0cdbae228d8dc911747800d19c47c0dd18cc7437ff4c0ba412be705c7cd1a3408fed72d38b72cfbbed3b3bc89f04ab5ff53f71b3956b82cf9de981a475dfadee4f126fee3ecd28c351d67be8a03bda9561afe78b0dfa7e2cc697cbb3116f216aec438196db1cec0892b24cfbfdb69d36889a6f11cbe233a5c07a582547eafcf0a1fae9ab3fa239f0a7712f07137095b29a295bec9f9e25dee1d69ad8dfd18d08960f2caeaf6f370b6a125c509ecb63d8a9d18671f1a0fd1b0ba0035b1a947baa0b3db0e0b202f710d9b90281dd5d7d5ea5184e4d5cc1a306eb15802ed456fd4ecea7924f5c1155214efa5e927e67eda5a317cec1d96da4009e5b355d2653faac849daf360dd74b0788bf678642b0cc0f6d1e82c88795af862c548fed2308d63ab2fadef33147383382c9f3ea6989e1dba7493c8f5ddbf87e5cfc65c4e734fc7a0f45da05d31496fd6bf9c977b4a2e7624e627eda96672be6820da1fc82e2cd14936d4ba7038f32e7972fbe5b51fafb7eae72c6a00e0f9cd97ae6fdab7a04091b90cf94ec72e3bdd3a6f828a6447f9560ba1d62e8f2bb95e41d9cb2220a4cf34f0d2ae7d2ca5e912209ac9c214294c431f2da90e27f6597bb70c879fff6430ea0529d68ae653a95c3c3838e8ce6601aacc011dcb01e638b531251e626bb71acee79087ff2f6dc151aaece18ec0263a17c1086b0bf349a8875e73f84ac3dee932faecaeb8d079b0d25ea3e56914910c4b37158050e8fd739448d9054af1114b30d297345c9392b36b068d142a4bdcc4a860146960d593f1e7a9b7b601a9665014e537aa7467cfc1e5eae8010ef93ab7fa7d87918dcf71acc370d704b4fc6ee9ae3bd650d72438ee297133531f70748c4b178d25dc699643b80151f0049f0cc225178005ffa26893553434a42c5da293e878be6c6a1b995a795a19a2ff03f2841525f1ffe611f6d345a03497001e65843ef3e852f3370dcb7fb2f39d60e37ca8ff422dd5bb4a52fc5d78773d57df0801af259d218000dcfbc2804e569c020413cd820221b8ab448b1a13f88823c14a5ad68c1ba85ef5f5956e5609d2b0b06cdeca107c3db1795f4b6b0efc0cb71c89058c2ee674c9b03a94d0e989470111a2380c542452af136ba05b8657c83829020cbbd1862021e2d3c57d942b50f23928b4e94a2be14bda1c435d4a2cf5efdca18219b156110f9b5e81836fa3014f8d2c253d7599f376151402e028a80b42d1d02590175665bcb098d17c9901278bd3c5c3ae1e16f381e38a0530a2e02bd7aa69c1cb4359efc8f01e00e8eb1c36cf778170ea74d9c85e0e61f9e26578ce44ef234414ecbb47c35149d111843f2ed50c59d13ea9c9de340d099dbb879404e6d1e26dec76a20e4d5813e90fcd9fe5b97e9b056742393a565eae53dce692ba8b0efb4986571843dc9d8a9825155b7f8d4521a89572828dcaf3890d4a6841ebd88c16ff6cb97a6be5badd7686e273a5ca3fec83c5728c449d4474f9b70830766550f31690560ece4af749bf25a572184672419ad7eb39bdf899b37a3c5bd4592ed2f951acf6313398a2920abbecdd2140896966b3bd7b56dbf2fade729df19ca902343c6c97b0ab171cad92001516975ebac43b538f0edf47f73bb3839a13e732367d24778152a9604beccb0388f230f3c0a311fc3592ccbd5e76db6fec19fa86042de43b12db57ca7c74d1ed37292fa4992b19042e4839b29603febe893c66041c5718085246efbfb3d0f75d73273b21fd8aedb35ea9df7f2e0f6b682a609acbc48065251b7a01673011f6bdf1b319c41f27e1c34a05ca55a00f366d0383c47c64cc697da1aff3eddba6118aff69a8dbf7067e7af39126d8aafaf546ca65f19ebad6c3915c0818c7ce97a2379867c1e3ef3c91e4fee574f2f980b5bba6313f9838e1e450d41a3365b8b958406e5cebdc18171ef690d3bee813e36408c92c9cf523b44d5d827bf4200f8760f5cb73b6c9b92f6c040f2d02e4f0ec2c4d0a2a47cd678d015cec1ade49eae0ac9768ecf8c704f72e2d02de201a6b5855ff025a77c339d847e1082405645b04ef2a5298bbda2aaa05e259e40fb455f5dbc667555be2d7ae30c900ca2e9d455e40c4a2a40e393ed7faadec697df4b164f0373b80a4a2873654b97831dd3513ea5d8d6c3514d8fb8a30849ad9a66f3f29bb041ae3a685d7a94b86a60290949451c72f250dbe60aaa832f050ba09f892382170c26caded246856bf56d091ae8e03b96ac2f8f14a100c6f139ab452e521be0d562edde33825a62b9ea635503d0ea22a65d6703801a3b1e76416d82061c5fdf4665c568f314c29ed70d706983c6441dcaf93965a630c317c7e3f177e80b778b506e95390aaf16cbc421fbe2c98f61fad1cf2d58da670f4ec5f83fd964bb9409f005ea8ecc3686dcada1abdf26666d01e49a6d46af31f315c058d71f5d888d4fed56f0a4e5860d9b71ebd671f7ba6d585f808d11e1766f7b368d0be48774eee6701871c9f63bd515e01b60ad3cea135ad640d45a48c823c43050ea1df631ebf4b579ecddffb4d657ce306707f0a81c336040b613e49b1ed12c20c2acc1c333f524727d810c0b87c56810b62bd6a4c3c12751c62dbfa1a4692dc8cf25db84be868582422bf20aff5081cde41007e87f876449a174f623366514640d36e5009540a30e4b3ece5b48d039af2f1ff755a21a0fcf1343c2a292065cecfdb5799d3b27ebf3a27fc74e4253300edd8ecf96050d861b075e9ca2cf2d24fd5897343f0dbdb0b007f8318379ffa419665d2777b5e25c439e58b87947cabb0b4005986b9eee462516f2030cf04d11cb69e28a4e43039657973a9b8b6ee68ebb3c33ed6ea021708c91b61948daee62f559e8129de2530731d908c9139eb1f9d1be65d8dcc9a91d623a2756f54a2696ba241d058d673b5c69ac1ba1c2a601870a5058bf8993068fbfb5d14e4fb5493354a2191430a0ed82c2384104ee93eb934ad468950eb1f4027da975b7dca25da26004b2907bc568e2bccf1fcae7ad7848055bcc96d190b53bfb880b926f1ab5eb2757382ae647c7d93fee3e5e9918c99a7cf6b1b00c120871e445ef1f99c5069e9bf88b6c5c7de0ae9e732894d49e5d96e6eeacc002f145f84ba5241eb74a7839615bb4138378d77e4b986052e47ed0ab8681389744a0580f7d8091f5b13786cd12b4513cfa9ef4201d2d9a512f2701cd7c9cd5e1f9ab7d851db45100492204ad27f8a1e9c0642771bfc1ac2343aefec704c64c48ac16181dc7a8f357352ba4599b9d05be80e5ba6a46959f13964034bc01d6b3a09c8fb4ea42770414532ad564ce2ef26e84eee62fb55cfa7ca151685d76c43058e5590dffce46b0ae799cb9da7683f19256f4246344cd452c79585c74fa1f3fa01e37c98d81a155ce351b09c99dc4dc3faf99d9de88c481ef8d838b840a60680f9ca7eb3e510a8009ecdde8be5f6d54eb0a606c7381ff31cf1a191e66ba3c64b61f441eb19caf8cbd15eeee909001375f9f70efb92bf8b9e89ffe5526aeebb0565023f62e0de015fc6f6a0dda288c30d307f5484b707040302a9205551251b5187e16f24075aefb25aa127240ba6f8c5dbb37a1aa73f1c00edc3c57d20c46f3ee21b882c8423d9b7fd52874c1c2e828b9ccee143e48553b79c3310483e24bc0fec6ed2a3132be0374a7c8ff5c11db78a36edc2ea2d380f8bd2793b816357fc7bac93066c61d120852f4b93dc8e67340020abac46e5804393217adb31fdec38fcd0c58cc6ad25fb1fc0e037c9a6cd7c0877f39ce8100ff3396ce728589e4efd714a1a16c088c5545d07237f9b4174afe9658dba7934f8673f0d2a7d17a0c4e3a8cb6cf33c39960f0999602cc28b03cad9cbe8f33441af33946b42a2452975b6d8594cbdd3222236b3e3f3c5c0a7a525233a525f6eccfdb8db9aa4659764ba555a4a06a6dbd9724ed7ba28b662f493c4f1a8b7b7c5e08759f5eaa5500ae33821a714fd23962566ffe194014dc01a1a2fcb0785d8b49613617581b873f7ea9d65e2ad84c38e423a0087503d525bf31f4a7255417ef2544591b6ff21bcba7fd5b978749f02656c38436f38d34dfcced11c5aa3c03008ad91f71d7cdf70e367d3b58aa11ce2f18be09b37bbe5c8d27c4ea1876377a919cea54cc4613c3291c377aa440ba08325e9733aafda1a986d2cb3c66f20b5605ccf71c5175653a55dc804b542550043ac7aa889e50e2f9ae0c8799a81d24c0609f6599dd20a78db7d6d0bf1157f6bde929d5e139ede01bf81b028fe116d3a7468c692606a581caccfd0d1648371fa0eaf1dbed316c2f71417a936efe513ddc702a24994e74c65cc739d535a3268a58cdb9115cd03661510df444b55c822f9d5c89bfe4da5db9961082fd1633d1f6e6322d4a3005d10b895efb834153a788e1d6e67be7b30c26181d4a0ce9aa062a3a0e2c33bb184154e47c38119b9a046b62f1ee3d90d7e588e18a6aa6af5909983fde021bf11f22c8d9c42da33bc76568544143735376228de8698430bf39a0d324d71f841cbfaadc27c4859bd4c93ac576b59c9c1846e6ee9a65ae35e09983f44822d0c1df3f2b1432f77e278966d80d1ef3d78c65bac4de966709bf1ecf8b2c787cb433c8b1a0c7a3b57c75cb64b78f06fa5a1dd2bea7c34fd3975ad3d192e28b22b138248470b9b699c9b01b10437877aace2d5e82048d77f3a5461f114630694b9826f2403a86f945aa0a2bba9c8766fa8879b73a15f4b8c1be76e11d8f432bb116c9cf7ff9ccf4a6b24eac5873c69ef3a1a5f256cfe63e2c242c9a886e444be990e8b92f82d558aeb13a7aa531ce10e31db379dd79d4a07475450805522fe42c328d0bb0dc9db03c28cb099016b56ad8669543ad2fcd114115e236fd1e254195f74433b191df1cb2b78448e735325d790ce295715f20ecaab2cb2a5f289af7744ac737c7eff8be1411cb21514113a2fc255462a9898fe8f50ca48deaaccb6facf0c954d2a82fccbc2e108d04b383c87d7b255a22edb8e55d36068c7ba0ab7dd3d261e7b905f2866791e614174d9d4604442be81096f74fd1dcc73d4912cc97342d8d1604e13044e0ed8bb98b1a4fb42e920ee4921479694225b8bf1297adf78e23c285a9b1fac0458837f80a2777c9eedfbf12810d4c0105112b0c7dccd2b894d2d868c028e8a8eb25e25928c93d25443690abacb2d3c2028a3de039333093338f7fe72f5e9134583595f539dce7fba7d3b9df49bfeafff2307dc093a3e0bb12a15091abeafe426442099ada2b910cd183716b658c9009396e4d6159f8702c22ed5d5561afaf6e7cf28f64b7a857a533cfd59bdb7abcae0542034729b47b6b8813d6b1e0d4a55b1ac02477773800f44e8ee997fa61f0caa3ed32d94b859ff7567c7d6833804957f7af2428cd190db3c1427f86d4ef445ec64f2097acd66da4d5ab63b04cf03f1eaa73c6d0a5ca6f4bc9a8f11de97e5f15d23918c2d8b651ebb21cd1d9b4e97340f73ea28a1f098d62b238323e741d61c099063d4fef097cf2185fdebc13b1112e621a57b5dc6cf322fa3eed861a843a16ab690102e8de16a02cc751d125e14d3df76057a534ca1086432e14385b6353d4a95e768341069d601e4015da0fd28ebad1518cfa0a99072d27c7e1770a647db556c55f882285aaf6291f4eef93c7004421e73ac5e90d545758852a2e7aa30fc52e9f5b14dfc130f9aa3b72c045f04b9e1a2c38f8590b1b71748766cf51acd0e03b5a77a9d8d50dcef1d6a381fdc8cc29a9dfbe68306a264a355cfbc4642230940736cd79c826bcb964e689bbc5dc6a1199093ac9e87d7effb9647d4ea4ff7a5a35dea772959279dd59c0f3643488d26bb44cc97a1f3416ba3da314652c90ef0ed2252c9f093e6b389b974437fd4ffcc4b354b736e5b5b50020ad7aedf5ed3b2f793b851c0c0fc007cde75f47c18df868d3765e988ce393b3bf8842c5326246b85086ce1687b854303c6a6fa54e8020cd22958c5442fe605f63fc8eb3b8c6c5280b8cef9a675ceb9175493dbfc639e058ca6bc5e5f91997acf3add1019287216161a34c64cf4d54a3d94653da17701df9d392fba3d05205ccf9af93b262ec6793ab7764cb5104ff61a6b254c386909f10b6dd7f5424f4c4c1ea9bc1b9114df95547164e343ffc96aa8621e11f2fa7545c0ca62b273b7bd00e682ec7affdeab286520abaae9458dc4157e2985218c9202aa699e40878fd0e69112a771d8aac2a6745f6527d17e2d97342e344756e778ea8225376cd047d9b6d22b270b354162c86b9b27872da0fb7cea95f6b3a1779d37c7320da476f9d6dc2d6824a8d043e316a505b37e2b1e85d6b8b8e0a1c3ba32362ca6253aaf4aa5030e75d4bf79fd58d9c4450f1552cf5be9a3316b96da1ee377fed47c799ae2742ae106be6a0253edaa3bbc7fc25550412eeb0a76c2ded1dee8506ae9a5b38e6b904523d8f22a031fe160d0840ef8b2d94acf529bdc01d700d5e5ab820287e93d95c4f169e16a9d8ab8a6a851f330389cf0380aa8090d02025d51d1d6b977f4ed30562721a72e550deec525ded92e2ee742f347cd2ff4080d067e408d4775de9a9244736db4f96aa58d21243ffe8e661abb03c3c2a30d6caacee58504d71926b1f4eaa33cc44c5c1dc00d0b03eb7acbb60026bad0e2c9cd5348f468ddb641c4c2131da5e90a17a8fd8193bee316f09575da95de76275eed2477a7d6edadc85c2a8829a2005824f851bbc71095bc6b8dc0a8bf89d5aab6f55e356e0eae4d34d0dbc1b93dac80c263c9fb9f19459d38a68c2c1d1144ddb4e11b4378a00e3213f246c3e20bc401ae534a964c145169b51731fc62425c25484145ffde33e58ddaed21680a73c176ca05df5abdf2998864cd8342cff771a334a1e982a2d505d0d982bdef3b20d65e307715672e21f1d1fea4a39efffa1024b68cb32ae08edac8206d5ca271a4414419c679c1e02041218a2ec2ed44d90ba31d1ce2db4311512f90dbaa714d3d5829d49cab2717a81b9bd76e09591408e88e79f30877820c748408478bdc92440fec3e45c5367bace7757274ef34026b93f8ba8b7b54294582a6ecc6993aeb0851c73618b8acfa257230aa51d02fed20bb8100f4b0e26608a25fd449efa9f3a7228799642bfe6f649a9cdc15e059fbc09b674fbeb5960a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> HTB-Sherlocks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
            <tag> Hackthebox </tag>
            
            <tag> HTB </tag>
            
            <tag> Sherlocks </tag>
            
            <tag> DFIR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HKCert CTF Forensic - Wheres the APT Attack 3 Guide</title>
      <link href="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/"/>
      <url>/2024/12/20/hkcert-Wheres-the-APT-Attack-3/</url>
      
        <content type="html"><![CDATA[<h1 id="HKCert-CTF-Forensic-Q3-Where’s-the-APT-Attack-APT攻擊在哪裡？-Hidden-Flag-隱藏旗"><a href="#HKCert-CTF-Forensic-Q3-Where’s-the-APT-Attack-APT攻擊在哪裡？-Hidden-Flag-隱藏旗" class="headerlink" title="HKCert CTF Forensic - Q3: Where’s the APT Attack?  APT攻擊在哪裡？ Hidden Flag? 隱藏旗?"></a>HKCert CTF Forensic - Q3: Where’s the APT Attack?  APT攻擊在哪裡？ Hidden Flag? 隱藏旗?</h1><h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><ul><li><strong>Author:</strong> Nightsedge</li><li><strong>Categories:</strong> forensics</li><li>Hidden Question!</li></ul><h2 id="Question-Description-zh-HK"><a href="#Question-Description-zh-HK" class="headerlink" title="Question Description (zh-HK)"></a>Question Description (zh-HK)</h2><p>請以第2題繼續。</p><p>您是高級網絡安全分析師。</p><p>您的經理要求您協助分析Windows內存映像，作為我們目前調查的一部分。</p><p>這臺受害機器已經被隔離，Windows內存映像已經被提取供您調查。</p><p>預計內存映像將揭示一個包含命令和控制（C2）進程的常見程序，通常被稱為信標 (beacon)。</p><p>隱藏旗。如果大神您找到的話請跟在下交流一下IR心法，</p><h2 id="Question-Description-en"><a href="#Question-Description-en" class="headerlink" title="Question Description (en)"></a>Question Description (en)</h2><p>Please continue from Q2.</p><p>You are the Senior Cybersecurity Analyst.</p><p>Your Manager is requesting your assistance in analyzing a Windows memory image as a component of our current investigation.</p><p>This victim machine has been isolated and the Windows memory image has been extracted for your review.</p><p>The memory image is expected to reveal a routine that includes a command and control (C2) process, commonly known as a beacon.</p><p>There is a hidden flag! It will be great to contact me if you can find it, you should be very great in IR.</p><h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ol><li>Review the C# DLL program from Q2</li><li>Guess the command and control (C2) framework</li><li>Read Didier Stevens’s articles from SANS (Strongly Recommended)</li><li>Decrypt and Parse the beacon file, and get the Cobalt Strike beacon setting profile</li></ol><h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><ul><li>Real Malware</li><li>Can bypass Anti-Virus Solutions</li><li>Almost no signature? maybe not?</li><li>Not useful: malfind (because no signature), yarascan (or you have your own great Yara signature)</li><li>The author (me) is too lazy to tidy up the write-ups~</li></ul><h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="1-Review-the-C-DLL-program-from-Q2"><a href="#1-Review-the-C-DLL-program-from-Q2" class="headerlink" title="1. Review the C# DLL program from Q2"></a>1. Review the C# DLL program from Q2</h3><p>The <code>mpclient.dll</code> called the <code>MsMpEng.dll</code> function <code>StartW</code> which is common export function from Cobalt Strike DLL stage&#x2F;stageless beacon.  </p><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.1.mpclient_main.png" class="" title="1.mpclient_main"><h3 id="2-Extract-profile-using-Sentinel-One’s-CobaltStrikeParser"><a href="#2-Extract-profile-using-Sentinel-One’s-CobaltStrikeParser" class="headerlink" title="2. Extract profile using Sentinel-One’s CobaltStrikeParser?"></a>2. Extract profile using Sentinel-One’s CobaltStrikeParser?</h3><p>Sorry, no matched starting point.<br>Because the shellcode is encrypted with an unknown XOR key. &#x3D;]  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 ./parse_beacon_config.py file.0xd88e42603e00.0xd88e4045bc70.ImageSectionObject.MsMpEng.dll.img</span><br></pre></td></tr></table></figure><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.2.failed_CobaltStrikeParser.png" class="" title="2.failed_CobaltStrikeParser"><h3 id="3-Analysis-of-an-Encoded-Cobalt-Strike-Beacon-by-Didier-Stevens"><a href="#3-Analysis-of-an-Encoded-Cobalt-Strike-Beacon-by-Didier-Stevens" class="headerlink" title="3. Analysis of an Encoded Cobalt Strike Beacon by Didier Stevens"></a>3. Analysis of an Encoded Cobalt Strike Beacon by Didier Stevens</h3><p>This very great article by Didier Stevens:<br><a href="https://isc.sans.edu/diary/Analysis+of+an+Encoded+Cobalt+Strike+Beacon/29014">https://isc.sans.edu/diary/Analysis+of+an+Encoded+Cobalt+Strike+Beacon/29014</a></p><p>Strongly recommended to read the article again!<br>Follow this article’s ideas and steps to continue your analysis.<br>XOR known plaintext attacks!<br>Use option <code>-g o</code> (o &#x3D; overlay) to extract the overlay, and <code>-g s</code> (s &#x3D; stripped) to extract the PE file without overlay.  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 pecheck.py file.0xd88e42603e00.0xd88e4045bc70.ImageSectionObject.MsMpEng.dll.img -g s -D | python3 xor-kpa.py -n cs-key-dot </span><br></pre></td></tr></table></figure><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.3.Analysisbeacon.png" class="" title="3.1.Analysisbeacon"><p>Now you can find the meanful strings, some windows API calls and file names.  </p><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.3.decoded_meanfulstrings.png" class="" title="3.2.decoded_meanfulstrings"><h3 id="4-Extract-the-Cobalt-Strike-profile-and-pretty-print-the-beacon-profile"><a href="#4-Extract-the-Cobalt-Strike-profile-and-pretty-print-the-beacon-profile" class="headerlink" title="4. Extract the Cobalt Strike profile and pretty print the beacon profile"></a>4. Extract the Cobalt Strike profile and pretty print the beacon profile</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 pecheck.py file.0xd88e42603e00.0xd88e4045bc70.ImageSectionObject.MsMpEng.dll.img -g s -D | python3 xor-kpa.py -n cs-key-dot -d &gt; cobaltstrike.sample</span><br><span class="line">python3 ./parse_beacon_config.py cobaltstrike.sample</span><br></pre></td></tr></table></figure><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.4.extractprofile.png" class="" title="4.extractprofile"><h3 id="5-Flag-from-profile"><a href="#5-Flag-from-profile" class="headerlink" title="5 Flag from profile"></a>5 Flag from profile</h3><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.5.profileflag.png" class="" title="5.1.profileflag"><img src="/2024/12/20/hkcert-Wheres-the-APT-Attack-3/5.6.flag.png" class="" title="5.2.flag"><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hkcert24&#123;4p7_4774ck_50154_c0b4l7_57r1k3_pr0f1l3_3x7r4c73d!&#125;</span><br></pre></td></tr></table></figure><h2 id="Reference-and-Respects"><a href="#Reference-and-Respects" class="headerlink" title="Reference and Respects"></a>Reference and Respects</h2><ul><li><a href="https://github.com/volatilityfoundation/volatility3">volatilityfoundation - Volatility3</a></li><li><a href="https://github.com/ufrisk/MemProcFS">ufrisk - MemProcFS</a></li><li><a href="https://isc.sans.edu/handler_list.html#didier-stevens">Didier Stevens - SANS</a></li><li><a href="https://isc.sans.edu/diary/Analysis+of+an+Encoded+Cobalt+Strike+Beacon/29014">Analysis of an Encoded Cobalt Strike Beacon - Didier Stevens</a></li><li><a href="https://github.com/Sentinel-One/CobaltStrikeParser">Sentinel-One - CobaltStrikeParser</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> HKcertCTF2024 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WindowsForensics </tag>
            
            <tag> Forensics </tag>
            
            <tag> HKcertCTF2024 </tag>
            
            <tag> MemoryForensic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HKCert CTF Forensic - Wheres the APT Attack 2 Guide</title>
      <link href="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/"/>
      <url>/2024/12/11/hkcert-Wheres-the-APT-Attack-2/</url>
      
        <content type="html"><![CDATA[<h1 id="HKCert-CTF-Forensic-Q2-Where’s-the-APT-Attack-APT攻擊在哪裡？-Suspicious-process-可疑進程"><a href="#HKCert-CTF-Forensic-Q2-Where’s-the-APT-Attack-APT攻擊在哪裡？-Suspicious-process-可疑進程" class="headerlink" title="HKCert CTF Forensic - Q2: Where’s the APT Attack?  APT攻擊在哪裡？ Suspicious process 可疑進程"></a>HKCert CTF Forensic - Q2: Where’s the APT Attack?  APT攻擊在哪裡？ Suspicious process 可疑進程</h1><h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><ul><li><strong>Author:</strong> Nightsedge</li><li><strong>Categories:</strong> forensics</li></ul><h2 id="Question-Description-zh-HK"><a href="#Question-Description-zh-HK" class="headerlink" title="Question Description (zh-HK)"></a>Question Description (zh-HK)</h2><p>請以第1題繼續。</p><p>您是高級網絡安全分析師。</p><p>您的經理要求您協助分析Windows內存映像，作為我們目前調查的一部分。</p><p>這臺受害機器已經被隔離，Windows內存映像已經被提取供您調查。</p><p>預計內存映像將揭示一個包含命令和控制（C2）進程的常見程序，通常被稱為信標 (beacon)。</p><p>請找出信標進程中的旗。只需要一點逆向技巧吧?</p><h2 id="Question-Description-en"><a href="#Question-Description-en" class="headerlink" title="Question Description (en)"></a>Question Description (en)</h2><p>Please continue from Q1.</p><p>You are the Senior Cybersecurity Analyst.</p><p>Your Manager is requesting your assistance in analyzing a Windows memory image as a component of our current investigation.</p><p>This victim machine has been isolated and the Windows memory image has been extracted for your review.</p><p>The memory image is expected to reveal a routine that includes a command and control (C2) process, commonly known as a beacon.</p><p>Please find the flag from the beacon process. Just need a bit of Reverse engineering technique?</p><h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ol><li>Open and analyze the memory image by using Volatility3 and MemProcFS</li><li>Identify the interesting persistence</li><li>Identify the malicious process</li><li>Identify the real malicious file and get flag from the process images</li></ol><h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><ul><li>Real Malware</li><li>Can bypass Anti-Virus Solutions</li><li>Almost no signature? maybe not?</li><li>Not useful: malfind (because no signature), yarascan (or you have your own great Yara signature)</li><li>The author (me) is too lazy to tidy up the write-ups~</li></ul><h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="1-Find-the-persistence-via-MemProcFS"><a href="#1-Find-the-persistence-via-MemProcFS" class="headerlink" title="1. Find the persistence via MemProcFS"></a>1. Find the persistence via MemProcFS</h3><p>After you checked a lot, you can find that there are 2 tasks one is <code>Windows Defender Scheduled Scan</code> and another one is <code>Windows Defender Scheduled Scan-1</code> because of the naming convention from MemProcFS.  </p><p>From <code>timeline_task.csv</code>, it already showed this abnormal task.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.abnormal_schtask.png" class="" title="1.1.abnormal_schtask"><p>There are 2 scheduled tasks with same name. However,</p><ul><li><code>Windows Defender Scheduled Scan-1</code> is created by the system, which is a real and legitimate task.</li></ul><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.schtasks_check1.png" class="" title="1.2.schtasks_check1"><ul><li><code>Windows Defender Scheduled Scan</code> is created by <code>DIGITALHARBOUR\night01</code>, which should not be a legitimate task, possibly persistence with a fake name.</li></ul><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.schtasks_check2.png" class="" title="1.3.schtasks_check2"><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.schtasks_check2-author.png" class="" title="1.4.schtasks_check2-author"><p>And its action is <code>ProgramData\Windows Defender\MpCmdRun.exe</code>, which seems a bit wired.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.schtasks_check2-action.png" class="" title="1.5.schtasks_check2-action"><p>Also, the <code>timeline_ntfs.csv</code> from MemProcFS shows that the file creation and the update on this folder <code>ProgramData\Windows Defender\</code>.  </p><h3 id="2-1-Using-netscan-function-to-get-all-the-network-connected-processes-and-export-as-CSV-format"><a href="#2-1-Using-netscan-function-to-get-all-the-network-connected-processes-and-export-as-CSV-format" class="headerlink" title="2.1 Using netscan function to get all the network connected processes and export as CSV format"></a>2.1 Using netscan function to get all the network connected processes and export as CSV format</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.netscan.NetScan &gt; ./review_records/windows.netscan.NetScan.csv</span><br></pre></td></tr></table></figure><p>Save it as a xlsx excel file and paste records to the new excel sheet.  </p><p>Although you can search the reputation of the ForeginAddr IP addresses Threat Intelligence (TI), you know those results are still unrated or safe.  </p><h3 id="2-2-Using-pstree-function-to-get-all-the-network-activities-processes-and-export-as-CSV-format"><a href="#2-2-Using-pstree-function-to-get-all-the-network-activities-processes-and-export-as-CSV-format" class="headerlink" title="2.2 Using pstree function to get all the network activities processes and export as CSV format"></a>2.2 Using pstree function to get all the network activities processes and export as CSV format</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.pstree.PsTree &gt; ./review_records/windows.pstree.PsTree.csv</span><br></pre></td></tr></table></figure><p>And copy the result to the netscan excel with a new sheet.  </p><h3 id="2-3-Filter-out-network-activities-process-by-looking-up-the-netscan-excel-results"><a href="#2-3-Filter-out-network-activities-process-by-looking-up-the-netscan-excel-results" class="headerlink" title="2.3 Filter out network activities process by looking up the netscan excel results"></a>2.3 Filter out network activities process by looking up the netscan excel results</h3><p><code>=INDEX(windows.netscan.NetScan!F:F, MATCH(windows.pstree.PsTree!$B2, windows.netscan.NetScan!$I:$I,0))</code></p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.3.filterprocess.png" class="" title="2.3.filter process"><p>Filter out the <code>N.A.</code> values.</p><p>Suggested to collect those PIDs and listing them for further investigation.  </p><h3 id="2-4-Short-Sumup-the-findings"><a href="#2-4-Short-Sumup-the-findings" class="headerlink" title="2.4 Short Sumup the findings"></a>2.4 Short Sumup the findings</h3><p>As an experienced blue team or IR member, you will find that the <code>MpCmdRun.exe</code> file path is not an expected path!  </p><p><code>MpCmdRun.exe (PID: 10344)</code> is the Microsoft Defender Anti-Virus Software CMD toolkit. (legit application)</p><p>The correct path is <code>\ProgramData\Microsoft\Windows Defender\Platform\&lt;antimalware platform version&gt;\MpCmdRun.exe</code> from Microsoft Document.<br><code>C:\\ProgramData\\Windows Defender\\MpCmdRun.exe</code> is not correct.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/3.4.MpCmdRun.png" class="" title="2.4.MpCmdRun"><p>Therefore, it is believed that it is not an expected process from an abnormal scheduled task.</p><h2 id="3-Find-the-real-malicious-file"><a href="#3-Find-the-real-malicious-file" class="headerlink" title="3. Find the real malicious file"></a>3. Find the real malicious file</h2><h3 id="3-1-Dump-the-possible-process-executable-files"><a href="#3-1-Dump-the-possible-process-executable-files" class="headerlink" title="3.1 Dump the possible process executable files"></a>3.1 Dump the possible process executable files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f /home/kali/Downloads/hk_oct_apt_attack.mem -o ./dump_temp/ windows.dumpfiles.DumpFiles --pid 10344</span><br></pre></td></tr></table></figure><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/4.1.dumpc2.png" class="" title="3.1.dumpc2"><h3 id="3-2-Review-all-files"><a href="#3-2-Review-all-files" class="headerlink" title="3.2 Review all files"></a>3.2 Review all files</h3><h3 id="3-3-found-interesting-C-DLLs"><a href="#3-3-found-interesting-C-DLLs" class="headerlink" title="3.3 found interesting C# DLLs"></a>3.3 found interesting C# DLLs</h3><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/4.3.interestingCsharpdlls.png" class="" title="3.3.interestingC#dlls"><h3 id="3-4-Decompile-C-DLL-using-ILSpy"><a href="#3-4-Decompile-C-DLL-using-ILSpy" class="headerlink" title="3.4 Decompile C# DLL using ILSpy"></a>3.4 Decompile C# DLL using ILSpy</h3><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/4.4.interestingCsharpfunctions.png" class="" title="3.4.interestingCsharpfunctions"><ul><li>The <code>EncryptedKey</code> contains the flag, but you need to use <code>key</code> and <code>iv</code> to decrypt it.</li><li>The <code>Main</code> function will call the loaded <code>MsMpEng.dll</code> with <code>StartW()</code> function which may contain the real C2 payload.</li></ul><h3 id="3-5-Decrypt-the-EncryptedKey"><a href="#3-5-Decrypt-the-EncryptedKey" class="headerlink" title="3.5 Decrypt the EncryptedKey"></a>3.5 Decrypt the <code>EncryptedKey</code></h3><p>Here is the decypt program in C#:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">decryptctf</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> key = <span class="string">&quot;0123456789ABCDEF0123456789ABCDEF&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> iv = <span class="string">&quot;ABCDEF0123456789ABCDEF0123456789&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> EncryptedKey = <span class="string">&quot;uT9PNcMlxqUI3e95Kq67i3inLuBCJ1DzpdFNNLviRFA69gpLbtz0fOk2pTY4j+YsivyqzgYtOi71TZSF/9IbRg==&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">StringToByteArray</span>(<span class="params"><span class="built_in">string</span> hex</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] array = <span class="keyword">new</span> <span class="built_in">byte</span>[hex.Length / <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; array.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                array[i] = Convert.ToByte(hex.Substring(i * <span class="number">2</span>, <span class="number">2</span>), <span class="number">16</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> array;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> cipherText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (Aes aesAlg = Aes.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                aesAlg.Key = StringToByteArray(key);</span><br><span class="line">                aesAlg.IV = StringToByteArray(iv);</span><br><span class="line"></span><br><span class="line">                ICryptoTransform decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">using</span> (MemoryStream msDecrypt = <span class="keyword">new</span> MemoryStream(Convert.FromBase64String(cipherText)))</span><br><span class="line">                <span class="keyword">using</span> (CryptoStream csDecrypt = <span class="keyword">new</span> CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))</span><br><span class="line">                <span class="keyword">using</span> (StreamReader srDecrypt = <span class="keyword">new</span> StreamReader(csDecrypt))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> srDecrypt.ReadToEnd();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(Decrypt(EncryptedKey));</span><br><span class="line">            Console.ReadKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Get the base64 encoded string.</p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/4.5DecryptedEncryptedKey.png" class="" title="3.5DecryptedEncryptedKey"><h3 id="3-6-Decode-again-and-get-the-flag"><a href="#3-6-Decode-again-and-get-the-flag" class="headerlink" title="3.6 Decode again and get the flag"></a>3.6 Decode again and get the flag</h3><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-2/4.6Decodedflag.png" class="" title="3.6Decodedflag"><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hkcert24&#123;4p7_4774ck_71574_dll_51d3_l04d1n6!&#125;</span><br></pre></td></tr></table></figure><h3 id="Next-lets-do-some-analysis-on-the-C2-beacon-Coming-Soon"><a href="#Next-lets-do-some-analysis-on-the-C2-beacon-Coming-Soon" class="headerlink" title="Next lets do some analysis on the C2 beacon~ (Coming Soon~)"></a>Next lets do some analysis on the C2 beacon~ (Coming Soon~)</h3>]]></content>
      
      
      <categories>
          
          <category> HKcertCTF2024 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WindowsForensics </tag>
            
            <tag> Forensics </tag>
            
            <tag> HKcertCTF2024 </tag>
            
            <tag> MemoryForensic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HKCert CTF Forensic - Wheres the APT Attack 1 Guide</title>
      <link href="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/"/>
      <url>/2024/12/11/hkcert-Wheres-the-APT-Attack-1/</url>
      
        <content type="html"><![CDATA[<h1 id="HKCert-CTF-Forensic-Q1-Where’s-the-APT-Attack-APT攻擊在哪裡？-Suspicious-file-可疑檔案"><a href="#HKCert-CTF-Forensic-Q1-Where’s-the-APT-Attack-APT攻擊在哪裡？-Suspicious-file-可疑檔案" class="headerlink" title="HKCert CTF Forensic - Q1: Where’s the APT Attack? APT攻擊在哪裡？ Suspicious file 可疑檔案"></a>HKCert CTF Forensic - Q1: Where’s the APT Attack? APT攻擊在哪裡？ Suspicious file 可疑檔案</h1><h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><ul><li><strong>Author:</strong> Nightsedge</li><li><strong>Categories:</strong> forensics</li></ul><h2 id="Question-Description-zh-HK"><a href="#Question-Description-zh-HK" class="headerlink" title="Question Description (zh-HK)"></a>Question Description (zh-HK)</h2><p>您是高級網絡安全分析師。</p><p>您的經理要求您協助分析Windows內存映像，作為我們目前調查的一部分。</p><p>這臺受害機器已經被隔離，Windows內存映像已經被提取供您調查。</p><p>預計內存映像將揭示一個包含命令和控制（C2）進程的常見程序，通常被稱為信標 (beacon)。</p><p>請找出常見有趣進程中可疑檔案中的旗。</p><h2 id="Question-Description-en"><a href="#Question-Description-en" class="headerlink" title="Question Description (en)"></a>Question Description (en)</h2><p>You are the Senior Cybersecurity Analyst.</p><p>Your Manager is requesting your assistance in analyzing a Windows memory image as a component of our current investigation.</p><p>This victim machine has been isolated and the Windows memory image has been extracted for your review.</p><p>The memory image is expected to reveal a routine that includes a command and control (C2) process, commonly known as a beacon.</p><p>Please find the flag from the suspicious file from the common interesting process?!</p><h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ol><li>Open and analyze the memory image by using Volatility3 and MemProcFS</li><li>Identify the interesting file and get the flag from the process dump</li></ol><h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><ul><li>Real Malware</li><li>Can bypass Anti-Virus Solutions</li><li>Almost no signature? maybe not?</li><li>Not useful: malfind (because no signature), yarascan (or you have your own great Yara signature)</li><li>The author (me) is too lazy to tidy up the write-ups~</li></ul><h2 id="GonJK-provided-a-detailed-step-by-step-guide-for-this-challenge-for-this-competition-please-give-him-respect-with-thanks"><a href="#GonJK-provided-a-detailed-step-by-step-guide-for-this-challenge-for-this-competition-please-give-him-respect-with-thanks" class="headerlink" title="GonJK provided a detailed step-by-step guide for this challenge for this competition, please give him respect with thanks"></a>GonJK provided a detailed step-by-step guide for this challenge for this competition, please give him respect with thanks</h2><h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><p>From the title of the question, already told that it is an APT Attack, APT means “Advanced persistent threat”.  </p><p>Therefore, if you understand this term, you can start by looking for persistent tactics on Windows OS.  </p><p>There is a good reference from MITRE ATT&amp;CK framework.  </p><p><a href="https://attack.mitre.org/matrices/enterprise/windows/">Windows Matrix</a></p><h2 id="1-Basic-Analysis-to-understand-the-memory-image-environment"><a href="#1-Basic-Analysis-to-understand-the-memory-image-environment" class="headerlink" title="1. Basic Analysis to understand the memory image environment"></a>1. Basic Analysis to understand the memory image environment</h2><h3 id="1-1-Using-Volatility3-commands-to-understand-the-memory-image-first"><a href="#1-1-Using-Volatility3-commands-to-understand-the-memory-image-first" class="headerlink" title="1.1 Using Volatility3 commands to understand the memory image first"></a>1.1 Using Volatility3 commands to understand the memory image first</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f hk_oct_apt_attack.mem windows.info.Info</span><br><span class="line">vol.py -f hk_oct_apt_attack.mem windows.envars.Envars</span><br><span class="line">vol.py -f hk_oct_apt_attack.mem windows.pstree.PsTree</span><br><span class="line">more...</span><br></pre></td></tr></table></figure><h3 id="1-2-Using-MemProcFS-Windows-to-mount-as-a-drive-and-understand-the-memory-image-first-Please-refer-to-GonJK-step-by-step-guide"><a href="#1-2-Using-MemProcFS-Windows-to-mount-as-a-drive-and-understand-the-memory-image-first-Please-refer-to-GonJK-step-by-step-guide" class="headerlink" title="1.2 Using MemProcFS (Windows) to mount as a drive and understand the memory image first (Please refer to GonJK step by step guide)"></a>1.2 Using MemProcFS (Windows) to mount as a drive and understand the memory image first (Please refer to GonJK step by step guide)</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\MemProcFS.exe <span class="literal">-device</span> .\hk_oct_apt_attack.mem <span class="literal">-forensic</span> <span class="number">1</span> <span class="literal">-v</span></span><br></pre></td></tr></table></figure><h3 id="1-3-Volatility3-result-to-CSV"><a href="#1-3-Volatility3-result-to-CSV" class="headerlink" title="1.3 Volatility3 result to CSV"></a>1.3 Volatility3 result to CSV</h3><p>Why CSV? Maybe it is easier to co-relate the records and&#x2F;or create a timeline in excel.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.netscan.NetScan &gt; ./review_records/windows.netscan.NetScan.csv</span><br><span class="line">vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.pstree.PsTree &gt; ./review_records/windows.pstree.PsTree.csv</span><br><span class="line">python3 vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.filescan.FileScan &gt; ./review_records/windows.filescan.FileScan.csv</span><br></pre></td></tr></table></figure><h2 id="2-Identify-the-interesting-file"><a href="#2-Identify-the-interesting-file" class="headerlink" title="2. Identify the interesting file"></a>2. Identify the interesting file</h2><h3 id="2-1-Way-1-Using-the-FileScan-function-to-find-the-interesting-file"><a href="#2-1-Way-1-Using-the-FileScan-function-to-find-the-interesting-file" class="headerlink" title="2.1. Way 1 - Using the FileScan function to find the interesting file"></a>2.1. Way 1 - Using the FileScan function to find the interesting file</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 vol.py -r csv -f /home/kali/Downloads/hk_oct_apt_attack.mem windows.filescan.FileScan &gt; ./review_records/windows.filescan.FileScan.csv</span><br></pre></td></tr></table></figure><p>You can go through all files, and there is a <code>.bat</code> inside the user(<code>night01</code>)’s Startup Folder <code>AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.1.findbatfile.png" class="" title="2.1.findbatfile"><p>Dump it for analysis.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 vol.py -f /home/kali/Downloads/hk_oct_apt_attack.mem -o ./dump_temp/ windows.dumpfiles.DumpFiles --virtaddr 0xd88e43c80bd0</span><br></pre></td></tr></table></figure><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.1.dumpbatfile.png" class="" title="2.1.dumpbatfile"><p>Failed to dump. sometimes like that, maybe the cache is corrupted or the MFT table is wrong.<br>You can try to fix this, but it will be hard to recover.  </p><p>Suggested to use MemProcFS to find it directly. Because MemProcFS already helped to fix this problem.<br><code>M:\forensic\ntfs\1\Users\night01\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Windows_Update_kb4781465.bat</code>  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.1.MemProcFSbatfile.png" class="" title="2.1.MemProcFSbatfile"><h3 id="Way-2-2-2-Investigate-the-powershell-process"><a href="#Way-2-2-2-Investigate-the-powershell-process" class="headerlink" title="Way 2 - 2.2 Investigate the powershell process"></a>Way 2 - 2.2 Investigate the powershell process</h3><p>The <code>cmd.exe</code> and <code>powershell.exe</code> are the interesting processes as always.  </p><p>We can dump the powershell process (PID: <code>2064</code>). and grep strings with <code>$</code> because powershell script defines variables using <code>$</code>.  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 vol.py -f /home/kali/Downloads/hk_oct_apt_attack.mem -o ./dump_temp/ windows.memmap.Memmap --pid 2064 --dump</span><br><span class="line">strings -n 8 ./dump_temp/pid.2064.dmp | grep <span class="string">&quot;\$&quot;</span>  &gt; ./dump_temp/strings8_out.txt</span><br></pre></td></tr></table></figure><p>if MemProcFS, check the minidump folder of the process.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.2.stringoutcontent.png" class="" title="2.2.stringoutcontent"><p>Now, The string output contains some interesting powershell commands:</p><ul><li><code>wevtutil el...</code></li><li><code>$base64String...</code></li><li><code>$newString...</code></li></ul><p>Back to the dump file and check those keywords again. You will find the following script.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.3.scriptcontent.png" class="" title="2.3.scriptcontent"><p>The script contains the following steps:</p><ul><li>clear the event logs</li><li>Base64 string</li><li>Reverse string</li></ul><p>And the “Write-Host” command contains the flag but you need to reverse the string and base64 decode it.  </p><p>Here is the flag.  </p><img src="/2024/12/11/hkcert-Wheres-the-APT-Attack-1/2.4reversedecodeflag.png" class="" title="2.4reversedecodeflag"><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hkcert24&#123;4p7_4774ck_600d_d1r3c710n_0n_7h15_m3m0ry_f0r3n51c&#125;</span><br></pre></td></tr></table></figure><h2 id="Hint-for-next-question-from-this-flag-“APT-attack-good-direction-on-this-memory-forensic”"><a href="#Hint-for-next-question-from-this-flag-“APT-attack-good-direction-on-this-memory-forensic”" class="headerlink" title="Hint for next question: from this flag “APT attack good direction on this memory forensic”"></a>Hint for next question: from this flag “APT attack good direction on this memory forensic”</h2><p>What’s the meaning of this hint?  </p><p>First of all, the bat file is place in <code>Users\night01\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> which is a typical persistence method.</p><h3 id="T1547-001-Boot-or-Logon-Autostart-Execution-Registry-Run-Keys-Startup-Folder"><a href="#T1547-001-Boot-or-Logon-Autostart-Execution-Registry-Run-Keys-Startup-Folder" class="headerlink" title="T1547.001: Boot or Logon Autostart Execution: Registry Run Keys &#x2F; Startup Folder"></a>T1547.001: Boot or Logon Autostart Execution: Registry Run Keys &#x2F; Startup Folder</h3><p>Please refer to the following URL link and read more about this technique:  </p><p><a href="https://attack.mitre.org/techniques/T1547/001/">https://attack.mitre.org/techniques/T1547/001/</a></p><h3 id="Therefore-Looking-at-persistence-is-a-good-direction-for-our-next-question"><a href="#Therefore-Looking-at-persistence-is-a-good-direction-for-our-next-question" class="headerlink" title="Therefore, Looking at persistence is a good direction for our next question."></a>Therefore, Looking at persistence is a good direction for our next question.</h3>]]></content>
      
      
      <categories>
          
          <category> HKcertCTF2024 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WindowsForensics </tag>
            
            <tag> Forensics </tag>
            
            <tag> HKcertCTF2024 </tag>
            
            <tag> MemoryForensic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Preparation of Windows Forensic Virtual Machine</title>
      <link href="/2024/10/27/Preparation-of-Windows-Forensic-Virtual-Machine/"/>
      <url>/2024/10/27/Preparation-of-Windows-Forensic-Virtual-Machine/</url>
      
        <content type="html"><![CDATA[<h3 id="Customizer-URL"><a href="#Customizer-URL" class="headerlink" title="Customizer URL"></a>Customizer URL</h3><p><a href="https://github.com/digitalsleuth/WIN-FOR">https://github.com/digitalsleuth/WIN-FOR</a></p><h3 id="Requirement"><a href="#Requirement" class="headerlink" title="Requirement"></a>Requirement</h3><ul><li>Windows 10 Virtual Machine (Suggested because of Windows 11 some annoying designs)</li><li>Latest Update</li></ul><h3 id="Installation-Steps"><a href="#Installation-Steps" class="headerlink" title="Installation Steps"></a>Installation Steps</h3><ol><li><p>Download the installer from release<br><a href="https://github.com/digitalsleuth/WIN-FOR/releases/">WIN-FOR</a></p></li><li><p>Right-click and run the installer as the administrator</p><img src="/2024/10/27/Preparation-of-Windows-Forensic-Virtual-Machine/winfor-customizer-menu.png" class=""></li><li><p>Click “Uncheck All”</p></li><li><p>Click “Requirements” Category</p></li><li><p>Check “Themed” and choose one of the themes</p></li><li><p>Install</p></li><li><p>Reboot</p></li><li><p>Check Errors and Fix Errors (with reboot)</p></li><li><p>Install all and reboot</p></li></ol><h3 id="Respects-and-Thanks"><a href="#Respects-and-Thanks" class="headerlink" title="Respects and Thanks"></a>Respects and Thanks</h3><ul><li><a href="https://github.com/digitalsleuth/WIN-FOR">digitalsleuth - WIN-FOR</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Forensics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WindowsForensics </tag>
            
            <tag> Forensics </tag>
            
            <tag> Toolbox </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
